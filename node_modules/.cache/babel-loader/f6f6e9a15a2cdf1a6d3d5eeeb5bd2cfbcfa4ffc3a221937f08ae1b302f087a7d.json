{"ast":null,"code":"\"use strict\";\n\nconst express = require('express');\nconst methodOverride = require('method-override');\nconst _ = require('lodash');\nconst lodashId = require('lodash-id');\nconst low = require('lowdb');\nconst Memory = require('lowdb/adapters/Memory');\nconst FileSync = require('lowdb/adapters/FileSync');\nconst bodyParser = require('../body-parser');\nconst validateData = require('./validate-data');\nconst plural = require('./plural');\nconst nested = require('./nested');\nconst singular = require('./singular');\nconst mixins = require('../mixins');\nmodule.exports = (db, opts) => {\n  opts = Object.assign({\n    foreignKeySuffix: 'Id',\n    _isFake: false\n  }, opts);\n  if (typeof db === 'string') {\n    db = low(new FileSync(db));\n  } else if (!_.has(db, '__chain__') || !_.has(db, '__wrapped__')) {\n    db = low(new Memory()).setState(db);\n  }\n\n  // Create router\n  const router = express.Router();\n\n  // Add middlewares\n  router.use(methodOverride());\n  router.use(bodyParser);\n  validateData(db.getState());\n\n  // Add lodash-id methods to db\n  db._.mixin(lodashId);\n\n  // Add specific mixins\n  db._.mixin(mixins);\n\n  // Expose database\n  router.db = db;\n\n  // Expose render\n  router.render = (req, res) => {\n    res.jsonp(res.locals.data);\n  };\n\n  // GET /db\n  router.get('/db', (req, res) => {\n    res.jsonp(db.getState());\n  });\n\n  // Handle /:parent/:parentId/:resource\n  router.use(nested(opts));\n\n  // Create routes\n  db.forEach((value, key) => {\n    if (key === '$schema') {\n      // ignore $schema\n      return;\n    }\n    if (_.isPlainObject(value)) {\n      router.use(`/${key}`, singular(db, key, opts));\n      return;\n    }\n    if (_.isArray(value)) {\n      router.use(`/${key}`, plural(db, key, opts));\n      return;\n    }\n    const sourceMessage = '';\n    // if (!_.isObject(source)) {\n    //   sourceMessage = `in ${source}`\n    // }\n\n    const msg = `Type of \"${key}\" (${typeof value}) ${sourceMessage} is not supported. ` + `Use objects or arrays of objects.`;\n    throw new Error(msg);\n  }).value();\n  router.use((req, res) => {\n    if (!res.locals.data) {\n      res.status(404);\n      res.locals.data = {};\n    }\n    router.render(req, res);\n  });\n  router.use((err, req, res, next) => {\n    console.error(err.stack);\n    res.status(500).send(err.stack);\n  });\n  return router;\n};","map":{"version":3,"names":["express","require","methodOverride","_","lodashId","low","Memory","FileSync","bodyParser","validateData","plural","nested","singular","mixins","module","exports","db","opts","Object","assign","foreignKeySuffix","_isFake","has","setState","router","Router","use","getState","mixin","render","req","res","jsonp","locals","data","get","forEach","value","key","isPlainObject","isArray","sourceMessage","msg","Error","status","err","next","console","error","stack","send"],"sources":["/Users/maxympetlyak/Desktop/REDUX/hero_admin_panel_template/node_modules/json-server/lib/server/router/index.js"],"sourcesContent":["\"use strict\";\n\nconst express = require('express');\nconst methodOverride = require('method-override');\nconst _ = require('lodash');\nconst lodashId = require('lodash-id');\nconst low = require('lowdb');\nconst Memory = require('lowdb/adapters/Memory');\nconst FileSync = require('lowdb/adapters/FileSync');\nconst bodyParser = require('../body-parser');\nconst validateData = require('./validate-data');\nconst plural = require('./plural');\nconst nested = require('./nested');\nconst singular = require('./singular');\nconst mixins = require('../mixins');\nmodule.exports = (db, opts) => {\n  opts = Object.assign({\n    foreignKeySuffix: 'Id',\n    _isFake: false\n  }, opts);\n  if (typeof db === 'string') {\n    db = low(new FileSync(db));\n  } else if (!_.has(db, '__chain__') || !_.has(db, '__wrapped__')) {\n    db = low(new Memory()).setState(db);\n  }\n\n  // Create router\n  const router = express.Router();\n\n  // Add middlewares\n  router.use(methodOverride());\n  router.use(bodyParser);\n  validateData(db.getState());\n\n  // Add lodash-id methods to db\n  db._.mixin(lodashId);\n\n  // Add specific mixins\n  db._.mixin(mixins);\n\n  // Expose database\n  router.db = db;\n\n  // Expose render\n  router.render = (req, res) => {\n    res.jsonp(res.locals.data);\n  };\n\n  // GET /db\n  router.get('/db', (req, res) => {\n    res.jsonp(db.getState());\n  });\n\n  // Handle /:parent/:parentId/:resource\n  router.use(nested(opts));\n\n  // Create routes\n  db.forEach((value, key) => {\n    if (key === '$schema') {\n      // ignore $schema\n      return;\n    }\n    if (_.isPlainObject(value)) {\n      router.use(`/${key}`, singular(db, key, opts));\n      return;\n    }\n    if (_.isArray(value)) {\n      router.use(`/${key}`, plural(db, key, opts));\n      return;\n    }\n    const sourceMessage = '';\n    // if (!_.isObject(source)) {\n    //   sourceMessage = `in ${source}`\n    // }\n\n    const msg = `Type of \"${key}\" (${typeof value}) ${sourceMessage} is not supported. ` + `Use objects or arrays of objects.`;\n    throw new Error(msg);\n  }).value();\n  router.use((req, res) => {\n    if (!res.locals.data) {\n      res.status(404);\n      res.locals.data = {};\n    }\n    router.render(req, res);\n  });\n  router.use((err, req, res, next) => {\n    console.error(err.stack);\n    res.status(500).send(err.stack);\n  });\n  return router;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}